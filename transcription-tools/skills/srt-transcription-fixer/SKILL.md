---
name: srt-transcription-fixer
description: SRT字幕ファイル専用の文字起こし修正スキル。Whisper等で生成されたSRTファイルの誤変換・不自然な改行位置を自動修正。Use PROACTIVELY when editing .srt files, fixing subtitle transcriptions, correcting SRT timing text, or when user mentions 字幕, SRT, 文字起こし修正, subtitle. transcription-fixerスキルと連携して誤変換を修正。
---

# SRT Transcription Fixer（SRT字幕修正スキル）

SRT形式の字幕ファイルに特化した文字起こし修正スキルです。

## 概要

Whisper等の音声認識で生成されたSRTファイルには、以下の問題が発生しやすい：

1. **誤変換** - 専門用語の誤認識（transcription-fixerで対応）
2. **不自然な改行位置** - 単語や助詞が行をまたいで分割される

このスキルは特に **2. 不自然な改行位置** の修正に特化しています。

## 使い方

### 基本的な使用

```
このSRTファイルの誤変換と改行位置を修正してください：
@path/to/subtitle.srt
```

### transcription-fixerとの連携

1. まず `transcription-fixer` スキルで誤変換を修正
2. 次に本スキルで改行位置を最適化

## SRT形式の構造

```srt
1
00:00:00,240 --> 00:00:02,380
字幕テキスト1行目

2
00:00:02,760 --> 00:00:05,060
字幕テキスト2行目
```

- **番号行**: 字幕の連番
- **タイムコード行**: 開始時間 --> 終了時間
- **テキスト行**: 表示される字幕テキスト
- **空行**: 各字幕ブロックの区切り

## 重要：タイムコードと区切り位置の扱い

### 原則

1. **タイムコード・字幕番号は変更しない** - 字幕の統合・分割は行わない
2. **テキストの区切り位置は調整してよい** - 数文字程度なら前後の字幕間で移動OK
3. **最重要：1行ごとの字幕が自然に完結すること** - 単語・専門用語が分断されないこと

### やるべきこと
- テキストの誤変換を修正する
- **単語の区切り位置を自然な位置に調整する**（前後の字幕間でテキストを移動）
- **行末の句読点（、。）を削除する**（字幕では不要）

### やってはいけないこと
- 複数の字幕を1つに統合してタイムコードを変更する
- 字幕番号を減らす（152→76などの大幅な統合）
- 字幕番号を増やす（新しい字幕ブロックを追加）

## 字幕分断への対応

Whisperは音声の区切りで自動分割するため、単語の途中で字幕が分かれることがある。
**タイムコードは維持しつつ、テキストの区切り位置を調整して自然な単語区切りにする。**

### 修正すべき分断パターン

```srt
# Before - 「ファイル」が不自然に分断
2
00:00:02,760 --> 00:00:05,920
Claude CodeではCLAUDE.mdというファイ

3
00:00:05,920 --> 00:00:09,960
ルに開発の共通のルールを設定することができます。

# After - 区切り位置を調整（タイムコードはそのまま）
2
00:00:02,760 --> 00:00:05,920
Claude CodeではCLAUDE.mdという

3
00:00:05,920 --> 00:00:09,960
ファイルに開発の共通のルールを設定することができます。
```

### 誤変換も同時に修正

```srt
# Before - 誤変換+不自然な分断
2
00:00:02,760 --> 00:00:05,920
クロードコードではcloud.mdというファイ

# After - 誤変換修正+区切り位置調整
2
00:00:02,760 --> 00:00:05,920
Claude CodeではCLAUDE.mdという
```

## 改行位置の修正ルール

### 絶対に区切ってはいけないパターン

#### 1. 複合語・固有名詞

| NG | OK |
|----|-----|
| `フロントエ` + `ンド` | `フロントエンド` |
| `バックエ` + `ンド` | `バックエンド` |
| `タイプスクリ` + `プト` | `TypeScript` |
| `クロードコ` + `ード` | `Claude Code` |
| `Claude Co` + `de` | `Claude Code` |
| `コンテキ` + `スト` | `コンテキスト` |
| `コンポーネ` + `ント` | `コンポーネント` |

#### 2. 動詞・形容詞の活用形

| NG | OK |
|----|-----|
| `読み込` + `まれている` | `読み込まれている` |
| `混在さ` + `せることも` | `混在させることも` |
| `実装して` + `いる時にも` | `実装している時にも` |
| `適用さ` + `れた` | `適用された` |
| `応じ` + `て` | `応じて` |

#### 3. ファイル名・拡張子・パス

| NG | OK |
|----|-----|
| `CLAUDE.m` + `d` | `CLAUDE.md` |
| `typescript.` + `md` | `typescript.md` |
| `general.` + `md` | `general.md` |
| `index.` + `ts` | `index.ts` |
| `pa` + `ths` | `paths` |

#### 4. スラッシュコマンド

| NG | OK |
|----|-----|
| `/me` + `mory` | `/memory` |
| `/con` + `text` | `/context` |
| `スラッシュコンテ` + `キスト` | `/context` |
| `スラッシュメモリー` | `/memory` |

#### 5. 助詞の分断・不自然な区切り

| NG | OK |
|----|-----|
| `APIの開` + `発ルール` | `APIの` + `開発ルール` |
| `フロントエンドの実装して` + `いる時` | `フロントエンドの` + `実装している時` |
| `ど` + `んどん` | `どんどん` |
| `AP` + `I` | `API` |
| `ルールと` + `して` | `ルール` + `として` |
| `必要に` + `応じ` + `て` | `必要に` + `応じて` |

#### 6. 接続助詞が行頭に残るパターン

接続助詞（ので、から、けど、が、て等）だけが次の行の頭に残るのはNG。前の行に含める。

| NG | OK |
|----|-----|
| `指定していない` + `ので、これは〜` | `指定していないので、` + `これは〜` |
| `思うんですけれども` + `、厄介なことに` | `思うんですけれども、` + `厄介なことに` |
| `できるんですが` + `、例えば〜` | `できるんですが、` + `例えば〜` |
| `なってきますけれども` + `、フロント〜` | `なってきますけれども、` + `フロント〜` |

### 推奨される区切り位置

1. **助詞の後** - 「は」「が」「を」「に」「で」「と」「や」「の」
2. **句読点の後** - 「、」「。」
3. **接続詞の前** - 「そして」「また」「さらに」「つまり」
4. **文節の切れ目** - 意味のまとまりを保つ

### 修正例

**Before:**
```srt
16
00:00:35,880 --> 00:00:38,520
この中にはフロントエンドのルールやバ

17
00:00:38,520 --> 00:00:40,700
ックエンドのルールなどいろいろと混在さ

18
00:00:40,700 --> 00:00:42,400
せることもあるかと思うんですけれども
```

**After:**
```srt
16
00:00:35,880 --> 00:00:38,520
この中にはフロントエンドのルールや

17
00:00:38,520 --> 00:00:40,700
バックエンドのルールなどいろいろと

18
00:00:40,700 --> 00:00:42,400
混在させることもあるかと思うんですけれども
```

## チェックリスト

修正時に確認すべき項目：

### 誤変換チェック（transcription-fixerと連携）
- [ ] Claude Code関連用語（CLAUDE.md, /context, /memory等）
- [ ] プログラミング用語（TypeScript, API, フロントエンド等）
- [ ] 固有名詞（とまだ, Claude等）

### 改行位置チェック
- [ ] 複合語が分断されていないか
- [ ] 動詞の活用形が分断されていないか
- [ ] ファイル名・拡張子が分断されていないか
- [ ] 助詞が文末に来ているか（次の行の先頭ではなく）

## AI Assistant Instructions

このスキルが起動されたら：

### 修正手順

1. **ファイル読み込み**
   - SRTファイルを読み込む
   - 全体の構造を把握

2. **誤変換修正（transcription-fixerと連携）**
   - Claude Code関連用語を正しい表記に
   - プログラミング用語を統一
   - 固有名詞を正確に

3. **改行位置最適化**
   - 単語の途中で区切られている箇所を特定
   - 助詞・句読点の位置を確認
   - 文節単位で自然な区切りに調整

4. **確認**
   - 全体を通して読み、不自然な箇所がないか確認

### 重要な注意点

- **タイムコードは変更しない** - テキストのみ修正
- **番号は変更しない** - 字幕の連番はそのまま
- **空行は保持** - SRT形式の構造を維持
- **文字数バランス** - 極端に長い/短い行を避ける

### 修正パターンの優先順位

1. 固有名詞・ファイル名の分断 → 最優先で修正
2. 動詞活用形の分断 → 必ず修正
3. 助詞の位置 → 文末に移動
4. 句読点の追加 → 自然な位置に補完

## スクリプト

### 行末句読点の一括削除

`scripts/remove_trailing_punctuation.py` - SRTファイル全体の行末句読点を一括削除

```bash
python scripts/remove_trailing_punctuation.py input.srt [output.srt]
```

- `output.srt`を省略すると`input.srt`を上書き
- 削除対象: 行末の「、」「。」
- 修正箇所を表示して確認可能

## 連携スキル

- **transcription-fixer** - 誤変換修正の辞書・ルールを参照
- **tomada-writing** - 日本語表現のスタイルガイド参照

## Version

**Current Version:** 1.4.0

### 更新履歴

- **1.4.0** (2025-12-11): 行末句読点削除ルールとスクリプトを追加
  - 字幕の行末に句読点（、。）は不要なため削除するルールを追加
  - `scripts/remove_trailing_punctuation.py` スクリプトを追加（一括削除用）
- **1.3.1** (2025-12-11): 接続助詞の行頭残りパターンを追加
  - 「ので」「から」「けど」等が行頭に残るのはNG、前の行に含めるルールを追加
- **1.3.0** (2025-12-11): テキスト区切り位置の調整方針を明確化
  - **重要な学び**: タイムコードは維持しつつ、テキストの区切り位置は調整してよい
  - 最重要原則を明記：「1行ごとの字幕が自然に単語・専門用語として完結すること」
  - 分断NGパターンを大幅追加（`Claude Co`+`de`、`ど`+`んどん`、`/me`+`mory`、`コンテキ`+`スト`等）
  - 修正例を実際の作業経験に基づいて更新
- **1.2.0** (2025-12-11): タイムコード維持の原則を追加
  - タイムコードは変更しない原則を明記
  - 字幕統合は行わず、テキストの誤変換のみ修正する方針に変更
- **1.1.0** (2025-12-11): 実際のSRT修正経験をもとに改善
  - キーワード分断パターンの例を追加
- **1.0.0**: 初版リリース
