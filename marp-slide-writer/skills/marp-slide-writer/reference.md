# Marp Slide Layout Reference

レイアウト制約の詳細仕様と計算根拠。

## Slide Dimensions

| 項目 | 値 |
|------|-----|
| スライドサイズ | 1280 × 720 px (16:9) |
| コンテンツ幅 | 1120 px (左右80pxパディング) |
| コンテンツ高さ | 520 px (上60px + 下140px字幕スペース) |
| subtitle-safe時の高さ | 480 px (下180pxパディング) |

## Typography

### Font Sizes

| 要素 | サイズ | line-height | 1行の高さ |
|------|--------|-------------|-----------|
| 本文 | 28px | 1.7 | 約48px |
| h1 | 2.2rem (≈62px) | 1.4 | 約87px |
| h2 | 1.5rem (≈42px) | 1.4 | 約59px |
| コード | 0.75rem (≈21px) | 1.5 | 約32px |
| small-text本文 | 24px | 1.7 | 約41px |
| テーブル | 0.9rem (≈25px) | - | 約45px |

### Content Height Calculation

```
利用可能高さ = 520px (通常) / 480px (subtitle-safe)

h1 = 87px
h2 = 59px
箇条書き1行 = 48px
コード1行 = 32px
テーブル1行 = 45px
説明文1行 = 48px
マージン = 約20px
```

## Layout Constraints (Detailed)

### h1 + Bullet List

```
利用可能: 520px
h1: 87px
残り: 433px
箇条書き1行: 48px
→ 433 ÷ 48 ≈ 9行

実測値: 8行で収まる、9行でギリギリ
推奨: 6行以内
```

**上限: 8行** | **推奨: 6行**

### h1 + Code Block

```
利用可能: 520px
h1: 87px
コードブロックpadding: 約25px
残り: 408px
コード1行: 32px
→ 408 ÷ 32 ≈ 12.75行

実測値: 12行で収まる、14行でやや窮屈
推奨: 10行以内
```

**上限: 12行** | **推奨: 10行**

### h1 + Description + Bullet List

```
利用可能: 520px
h1: 87px
説明文: 48px
マージン: 20px
残り: 365px
→ 365 ÷ 48 ≈ 7.6行

実測値: 6行で収まる
推奨: 5行以内
```

**上限: 6行** | **推奨: 5行**

### h1 + Description + Code Block

```
利用可能: 520px
h1: 87px
説明文: 48px
コードpadding: 25px
残り: 360px
→ 360 ÷ 32 ≈ 11.25行

実測値: 10行で収まる
推奨: 8行以内
```

**上限: 10行** | **推奨: 8行**

### h1 + Bullet List + Code Block

```
利用可能: 520px
h1: 87px
箇条書き3行: 144px
マージン: 20px
コードpadding: 25px
残り: 244px
→ コード約7行

実測値: 箇条3行 + コード5行で収まる
推奨: 箇条2行 + コード4行
```

**上限: 箇条3行 + コード5行** | **推奨: 箇条2行 + コード4行**

### h1 + Table

```
利用可能: 520px
h1: 87px
テーブルヘッダ: 55px
マージン: 20px
残り: 358px
テーブル1行: 45px
→ 358 ÷ 45 ≈ 7.95行

実測値: 8行（ヘッダ含む）で収まる
推奨: 6行（ヘッダ含む）
```

**上限: 8行(ヘッダ含む)** | **推奨: 6行**

### no-header + Code Only

```
利用可能: 540px (上部パディング縮小)
コードpadding: 25px
残り: 515px
→ 515 ÷ 32 ≈ 16行

実測値: 17行で収まる、20行ではみ出し
推奨: 14行以内
```

**上限: 17行** | **推奨: 14行**

### small-text + Bullet List

```
本文1行: 41px
利用可能: 520px
h1(small): 50px
残り: 470px
→ 470 ÷ 41 ≈ 11.5行

実測値: 10行で収まる、11行でギリギリ
推奨: 8行以内
```

**上限: 10行** | **推奨: 8行**

### subtitle-safe + Bullet List

```
利用可能: 480px
h1: 87px
説明文: 48px
残り: 345px
→ 345 ÷ 48 ≈ 7.2行

実測値: 説明文込みで5行、説明文なしで6行
推奨: 4行以内
```

**上限: 5行(説明文あり)** | **推奨: 4行**

## Text Length Constraints

| 要素 | 最大文字数 | 推奨文字数 |
|------|-----------|-----------|
| h1タイトル | 30文字 | 20文字 |
| 箇条書き1行 | 45文字 | 35文字 |
| 説明文1行 | 50文字 | 40文字 |
| コード1行 | 60文字 | 50文字 |

### Calculation Basis

```
コンテンツ幅: 1120px
本文28px × 0.5 (平均文字幅) = 14px/文字
→ 1120 ÷ 14 ≈ 80文字（英数字）
→ 日本語は約45文字（全角1.5倍計算）
```

## Nested List Constraints

| ネストレベル | 推奨項目数 |
|-------------|-----------|
| 1階層 | 6-8項目 |
| 2階層 | 親3 × 子2 = 合計9項目 |
| 3階層 | 非推奨（視認性低下） |

## CSS Class Effects

### Layout Impact

| クラス | 高さへの影響 |
|--------|-------------|
| `title` | 中央揃え、全高さ利用可能 |
| `section` | 中央揃え、h2のみ推奨 |
| `no-header` | +20px（上部パディング縮小） |
| `subtitle-safe` | -40px（下部パディング拡大） |
| `small-text` | 行あたり約7px節約 |
| `align-center` | 高さ変化なし |

### Combination Effects

```markdown
<!-- _class: no-header small-text -->
→ コード約20行まで可能

<!-- _class: subtitle-safe small-text -->
→ 箇条書き約7行まで

<!-- _class: no-header subtitle-safe -->
→ コード約14行まで
```

## Validation Rules

検証スクリプト `validate_slides.py` は以下をチェック:

1. **行数チェック**: 各構成の上限を超えていないか
2. **文字数チェック**: 1行が長すぎないか
3. **ネストチェック**: 3階層以上のネストがないか
4. **複数コードブロック**: 1スライドに2つ以上のコードブロックがないか
5. **クラス整合性**: 使用クラスと内容が適切か

### Error Levels

| レベル | 意味 |
|--------|------|
| ERROR | 確実にはみ出す。修正必須 |
| WARNING | ギリギリ。修正推奨 |
| INFO | 推奨値超過。確認推奨 |

## Quick Decision Guide

### 「何行まで入る？」フローチャート

```
Q: h1がある？
├─ Yes
│  Q: 説明文がある？
│  ├─ Yes
│  │  Q: コード？箇条書き？
│  │  ├─ コード → 8行推奨、10行上限
│  │  └─ 箇条書き → 5行推奨、6行上限
│  └─ No
│     Q: コード？箇条書き？テーブル？
│     ├─ コード → 10行推奨、12行上限
│     ├─ 箇条書き → 6行推奨、8行上限
│     └─ テーブル → 6行推奨、8行上限
└─ No (no-header)
   → コード14行推奨、17行上限
```

### 「はみ出しそう」対処法

1. **まず分割**: 2スライドに分ける
2. **次にsmall-text**: `<!-- _class: small-text -->`
3. **それでも無理なら**:
   - コード: コメント削除、変数名短縮
   - 箇条書き: 文言簡潔化、項目統合
   - テーブル: 列削減、別スライドに分割
